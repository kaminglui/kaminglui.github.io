import{r as S}from"./site-header-DlLg5oTJ.js";let b=!1,y=!1;function T(){if(y)return;const d=S()??document.querySelector(".nav"),a=(d==null?void 0:d.querySelector(".nav-toggle"))??document.querySelector(".nav-toggle"),i=(d==null?void 0:d.querySelector(".nav-links"))??document.querySelector(".nav-links");if(!d||!a||!i)return;if(d.dataset.navEnhanced==="true"){y=!0;return}const f=document.body,x=Array.from(d.querySelectorAll(".nav-item--dropdown")),v=[],c=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(hover: none)"):null,h=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(hover: hover)"):null,w=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: fine)"):null,u=()=>{const e=(c==null?void 0:c.matches)??!1,t=(h==null?void 0:h.matches)??!1,n=(w==null?void 0:w.matches)??!1;return e||!t||!n},r=({except:e}={})=>{let t=!1;return v.forEach(n=>{n!==e&&n.isOpen()&&(n.close(),t=!0)}),t};if(x.forEach(e=>{const t=e.querySelector(".nav-dropdown-toggle"),n=e.querySelector(".nav-dropdown-menu");if(!(t instanceof HTMLElement)||!(n instanceof HTMLElement))return;let m=null;const p=()=>{m!==null&&(window.clearTimeout(m),m=null)},M=()=>{u()||(p(),m=window.setTimeout(()=>{!e.matches(":hover")&&!n.matches(":hover")&&!t.matches(":hover")&&s.close()},220))},s={wrapper:e,toggle:t,menu:n,isOpen:()=>t.getAttribute("aria-expanded")==="true",open:()=>{t.setAttribute("aria-expanded","true"),e.setAttribute("data-open","true"),n.hidden=!1,p()},close:()=>{t.setAttribute("aria-expanded","false"),e.setAttribute("data-open","false"),n.hidden=!0,p()}};s.close(),v.push(s);const E=()=>{r({except:s}),s.open()},g=()=>{u()||(p(),E())},L=()=>{u()||M()};e.addEventListener("pointerenter",g),e.addEventListener("pointerleave",L),t.addEventListener("pointerenter",g),t.addEventListener("pointerleave",L),n.addEventListener("pointerenter",g),n.addEventListener("pointerleave",L),e.addEventListener("focusin",o=>{const l=o.target;u()&&l instanceof HTMLElement&&!l.matches(":focus-visible")||E()}),e.addEventListener("focusout",o=>{const l=o.relatedTarget;(!(l instanceof Node)||!e.contains(l))&&s.close()}),t.addEventListener("click",o=>{u()&&(o.preventDefault(),o.stopPropagation(),s.isOpen()?s.close():E())}),t.addEventListener("keydown",o=>{if(o.key==="ArrowDown"){o.preventDefault(),s.isOpen()||E();const l=n.querySelector("a");l instanceof HTMLElement&&l.focus()}else o.key==="Escape"&&s.close()}),n.addEventListener("click",o=>{o.target instanceof HTMLAnchorElement&&r()}),n.addEventListener("keydown",o=>{o.key==="Escape"&&(o.stopPropagation(),s.close(),t.focus())})}),c){const e=()=>{r()};typeof c.addEventListener=="function"?c.addEventListener("change",e):typeof c.addListener=="function"&&c.addListener(e)}window.addEventListener("resize",()=>{r()}),v.length>0&&!b&&(document.addEventListener("pointerdown",e=>{const t=e.target;t instanceof Node&&v.some(({wrapper:n})=>n.contains(t))||r()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&r()}),b=!0),a&&(a.addEventListener("click",()=>{const e=a.getAttribute("aria-expanded")==="true";r(),a.setAttribute("aria-expanded",String(!e)),i==null||i.setAttribute("data-visible",String(!e)),f.classList.toggle("nav-open",!e)}),window.addEventListener("keydown",e=>{e.key==="Escape"&&a.getAttribute("aria-expanded")==="true"&&(a.setAttribute("aria-expanded","false"),i==null||i.setAttribute("data-visible","false"),f.classList.remove("nav-open"),r(),a.focus())}),window.addEventListener("resize",()=>{window.innerWidth>=720&&(a.setAttribute("aria-expanded","false"),i==null||i.setAttribute("data-visible","false"),f.classList.remove("nav-open"),r())})),i==null||i.addEventListener("click",e=>{e.target instanceof HTMLAnchorElement&&(a==null||a.setAttribute("aria-expanded","false"),i.setAttribute("data-visible","false"),f.classList.remove("nav-open"),r())}),d.dataset.navEnhanced="true",y=!0}const A=()=>T();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",A,{once:!0}):A();export{T as setupNav};
